INTSourceChangelist:2726407
Availability:Public
Title:マチネ
Crumbs:%ROOT%, Resources, Resources/Showcases
Description:マチネのサンプルと構成の概要 
Related:Engine/Matinee
Related:Engine/Matinee/TrackReference
Related:Engine/Rendering\PostProcessEffects
Related:Engine\Rendering\PostProcessEffects\DepthOfField
Related:Engine\UI\CurveEditor
Related:Engine/Rendering/ParticleSystems
Related:Engine/Blueprints
Related:Engine/Basics/Projects/CreatingTemplates
Version:4.9


[VAR:Topic]
[OBJECT:Topic]
	[PARAM:image]
		![%Resources/Showcases/MatineeFightScene:title%](MatineeTopic.png)
	[/PARAM]
	[PARAM:icon]
		![](%ROOT%/rendering_icon.png)(convert:false)
	[/PARAM]
	[PARAM:title]
		%Resources/Showcases/MatineeFightScene:title%
	[/PARAM]
	[PARAM:description]
		%Resources/Showcases/MatineeFightScene:description%
	[/PARAM]
	[PARAM:path]
		[RELATIVE:Resources/Showcases/MatineeFightScene]
	[/PARAM]
[/OBJECT]
[/VAR]

[VAR:TopicCompact]
[OBJECT:TopicCompact]
	[PARAM:image]
		![%Resources/Showcases/MatineeFightScene:title%](MatineeTopic.png)
	[/PARAM]
	[PARAM:icon]
		![](%ROOT%/rendering_icon.png)(convert:false)
	[/PARAM]
	[PARAM:title]
		%Resources/Showcases/MatineeFightScene:title%
	[/PARAM]
	[PARAM:description]
		%Resources/Showcases/MatineeFightScene:description%
	[/PARAM]
	[PARAM:path]
		[RELATIVE:Resources/Showcases/MatineeFightScene]
	[/PARAM]
[/OBJECT]
[/VAR]



[REGION:fullwidth]
![](MatineeBanner.png)
[/REGION]

[TOC(start:2 end:2)]

**マチネ** のサンプルでは、アンリアル エンジン 4 の **マチネ エディタ** を使って、非常に定型化されたシネマティック シーケンスの作成方法を紹介します。マチネをご存知ない方もいるかと思います。マチネ エディタ (または単に マチネ) とは特別なアニメーション トラックの使用に基づいたシステムで、レベル内の **アクタ** に対して **キーフレーム** を配置し、特定プロパティ値を設定することができます。これらは時間経過に合わせた調整ができます。 

このページでは、連続した格闘シーンの作成に使用する Matinee アクタ内の各セクションを取り上げて、各エレメントがどのように結びつくと、次の『 **シーンの詳細** 』セクションのようなシーンが出来上がるのかを説明していきます。構成を理解すれば、修正してひねりを加えてみたり、あるいは習得した知識や小技を自分自身のシーンに活用することができるようになります。 

さらに [](Engine\Matinee) ドキュメントをご覧になって、マチネの使い方も学習することができます。 


## シーン処理の内容

出来上がりのシーンはこちらです。これを分割していきます。 

[OBJECT:EmbeddedVideo]
[PARAMLITERAL:width]
640
[/PARAMLITERAL]
[PARAMLITERAL:height]
360
[/PARAMLITERAL]
[PARAMLITERAL:videoid]
E0L7pBBhwUo
[/PARAMLITERAL]
[/OBJECT]


* シーンは、68 秒間のシーケンスで相互作用し合う 5 つのキャラクターで構成されます。 
* それぞれモーションキャプチャされた専用の **アニメーション シーケンス** がキャラクターに使用されます。 
* シーンには 6 台のカメラが使用されます (メインに移動用の 3 台、 「手振れ」タイプの移動用に子カメラが 3 台)。 
* 音楽は、シーケンスの指定時間に別々に呼び出される 9 種類の **サウンド ウェーブ** で構成されます。 
* インパクト サウンド、サウンド エフェクト、唸り音、 VO はすべて、シーケンスの適切な時間にキーフレームによって個別に追加されていきます。 
* キーフレームによる相互作用時に、パーティクル エフェクトがキャラクターと背景に適用されます。 
* メイン ライトとサブ ライトを使って、ライティングをシーンで調整します (ライトは 1 セットだけではなく複数のライトを調整します)。 
* **Slomo** トラックを使って指定したポイントでシーケンスを遅くし、 **Fade** トラックを使って最後にシーンをフェードアウトします。 
* **Event トラック** を使って、呼び出されると物理をシミュレーションするように (壁から崩れるタイルのシミュレーションに使用する) 複数の **スタティック メッシュ** を設定 (リセット) します。 


## Matinee アクタを開く

プロジェクトを起動しマチネを開いておくと、これからページを進めていく時に順番を追いやすく、値もリアルタイムで調整できるので便利です。 

**マチネ** の **ワールド アウトライナー** を検索すればマチネを開くことができます。 

![](SceneOutlinerMatinee.png)

**ワールド アウトライナー** の **[Matinee]** をクリックすると、 **[Details (詳細)]** パネルがエントリされます。ここから **[Open Matinee (マチネを開く)]** を選択できます。 

![](OpenMatinee.png)

**[Matinee]** ウィンドウが開きます。 

[REGION:lightbox]
[![](MatineeOpen.png)(w:720)](MatineeOpen.png)
[/REGION]

_画像をクリックして全画面表示にします。_ 


## ビューポートを調整する 

**[Matinee]** ウィンドウが開いている間、ビューポートが多数の色のついている点線であふれ、スクリーンが黒く見えることに気がつくと思います。 

![](MatineeNonGameView.png)(w:720)

ビューポートの左上隅にある下向き矢印をクリックして **ゲーム ビュー** にすれば、これらの点線やエディタ関係のアイコンを簡単に非表示にすることができます。 

![](ToggleGameViewOff.png)(w:720)

メニューから **[Game View (ゲームビュー)]** チェック ボックスを選択します。 

[REGION:tip]
ビューポートにしている時に **G** キーを押せば、このオプションを簡単にオンとオフに切り替えることができます。
[/REGION]

**ゲーム ビュー** が有効になっていると、 **マチネ** シーケンスを **[Matinee Editor]** ウィンドウから再生し、エディタ アイコンを表示させなくても出来上がりシーンを確認することができます。 

[OBJECT:ComparisonSlider]
	[PARAM:before]
	![Game View Off](GameViewOff.png)(w:600)
	[/PARAM]
	[PARAM:after]
	![Game View Om](GameViewOn.png)(w:600)
	[/PARAM]
[/OBJECT]


[REGION:tip]
メニュー ツールバーの **[View(表示)]** オプションの **マチネ エディタ** の中で、 **[Hide All 3D Trajectories (3D 軌道をすべて非表示)]** を選択すると、他のエディタのアイコンは表示したまま移動パスだけを非表示にできます。 
[/REGION]

黒くなってしまったスクリーンについては、 **Fade トラック** を使って黒いスクリーンからシーンをフェードインさせました。 

![](MatineeFadeTrack.png)

**Fade トラック** 上のどの位置でも、あるいは 2 番目のキーフレーム以降に **タイム バー** をスクラブすると、ビューポートにシーンが表示されるのが分かります。 


## Matinee アクタを分解する

以下のセクションでは、戦闘シーケンスの作成に使われた **マチネ** を分解し、それぞれの **トラック** を見ることでそれがどのようにまとめられ、どのように使用されていたのかを考察していきます。**Director グループ** と関連する **トラック** を見ていくと同時に、最終結果を生み出すために弊社のチームが使用しているテクニックについても考察します。 

まず初めに、 マチネ シーケンスの本質であるトラックを見てみましょう。Camera トラックからリスト順に説明していきます。 

### Camera トラック

『シーンの詳細』セクションで述べたように、メインのカメラ 3 台と子カメラ 3 台でこのシーンのカメラ設定を行います。**カメラ** 用の **ワールド アウトライナー** 内を検索すると、以下のようなものが見つかります。 

![](MatineeCameras.png)

**Camera1** 、 **Camera2** 、 **Camera3** に対して、 2 つ目のカメラ (**_Shake** が付け足されます) が作成されレベル内に配置されました。これらの **Shake** カメラを、それぞれが該当する親カメラ上にドラック＆ドロップすることで子カメラが作成されます。子カメラは、常に親カメラに追従します。こうすることで、既に移動中でパスに沿って動いているカメラに、わずかな動きを追加することができます。 

**マチネ** を開くと、「 **Cameras_Main** 」および「 **Cameras_Shake** 」という名前のフォルダがあります。「**Cameras_Main** 」フォルダ内のカメラはどれも写真用には使われませんが、それらは「 **Cameras_Shake** 」フォルダ内の各カメラに移動を与えます。 

[REGION:lightbox]
[![](CameraTrackExplained.png)(w:720)](CameraTrackExplained.png)
[/REGION]

_画像をクリックして全画面表示にします。_ 

[REGION:tip]
フォルダを使って、フォルダに割り当てられているグループを整理するだけでなく、折りたたみや展開も可能になります。フォルダを作成するには、 **[Tracks]** ウィンドウを **右クリック** して **[Add New Folder (新規フォルダを追加)]** を選択します。フォルダが追加されたら、そのフォルダを **右クリック** して **[Move Group Into Folder(グループをフォルダへ移動)]** を選び、フォルダの移動先となるグループを選択します。 
[/REGION]

セクション 1 では、タイムラインをスクラブすると、 **Director** トラック上のそれぞれのショットが子カメラを使っていることが分かります (最終ショットだけは例外で、カメラに適用する **揺れる** エフェクトがありません)。セクション 2 では、 **Camera1** はキーフレーム (赤いトライアングル) の幾つかがカメラのメインのパスを決定する **Movement** トラックに追加されています。**Camera_Shake1** のセクション 3 では、カメラが若干揺れて手振れのように見せる **Movement** トラックにさらに多くのキーフレームが追加されていることが分かります。 

#### カメラのプロパティ

**New Camera Group** が **マチネ** に追加されると、 編集可能な **Movement** トラックと **FOV Angle** トラックのみが表示されます。 

![](NewCameraAdded.png)

**Camera** トラックを **右クリック** し、表示されるコンテキスト メニューから **Add New Float Property Track** を選択すると、浮動小数点値により追加および調整可能なトラックのリストが表示されます。 

![](AddFloatPropertyTrack.png) ![](CameraFloatProperties.png)

追加および調整可能なプロパティ トラックが幾つかある中で、 **ポストプロセス設定** 用の以下の 6 つのトラックをこの **マチネ** で使用されている各カメラに追加しました。 

| プロパティ名 | 説明 |
| ------- | ------------ |
| **DepthOfFieldFocalDistance** | 被写界深度 (DOF) エフェクトがシャープになる距離です。アンリアル単位 (cm) です。 |
| **DepthOfFieldFocalRegion** | すべてのコンテンツに焦点が当てられた人工的な領域です。アンリアル単位 (cm) で DepthOfFieldFocalDistance の後に開始します。 |
| **DepthOfFieldScale** | BokehDOF 限定: DOF エフェクトを増幅します (カメラの開口部に類似)。値を 0 に設定すると、オフになります。 |
| **DepthOfFieldNearBlurSize** | ガウス分布限定：近いオブジェクトに対する DOF ブラーの最大サイズ (ビュー幅の比率)。注: パフォーマンス負荷は大きさに応じて増減します。 |
| **DepthOfFieldFarBlurSize** | ガウス分布限定：遠いオブジェクトに対する DOF ブラーの最大サイズ (ビュー幅の比率)。注: パフォーマンス負荷は大きさに応じて増減します。 |
| **DepthOfFieldMaxBokehSize** | BokehDOF 限定: DOF ブラーの最大サイズ (ビューの幅に対する比率)。注: パフォーマンス負荷はサイズ*サイズで増減します。 |

[REGION:note]
Depth Of Field の使用に関する詳細は [](Engine\Rendering\PostProcessEffects\DepthOfField) を参照してください。 
[/REGION]

上記のプロパティは **Camera アクタ** の **[Details]** パネルの **[Depth Of Field]** セクションで調整可能な設定と同じです。 

![](DetailsDOF.png)

それぞれのキーフレームを **右クリック** して **[Set Value (値を設定)]** オプションを選択すると、それぞれのプロパティの値を表示 / 変更できます。 

![](KeyFrameSetValue.png)

表示された入力ボックスで、指定したキーフレームのプロパティに使用する値を新しく設定することができます。 

![](KeyFrameNewValue.png)

**Director** トラックが使用中のカメラに対しカットするたびに、これらのプロパティのキーフレームが追加され編集が可能になります。 

[REGION:lightbox]
[![](CameraCutsDOF.png)(w:780)](CameraCutsDOF.png)
[/REGION]

_画像をクリックして全画面表示にします。_ 

それにより、カメラごとの各カットの DOF 設定 (および **Movement** と **FOV Angle** も) の編集が容易になり、値を調整すれば見え方を変更できます。 


### Character トラック

この **マチネ** の **Character** トラックはとても分かりやすくなっています。

* **Trooper_Lead Skeletal Mesh** を使用するメイン キャラクターを表す **Trooper_Main** トラックがあります。 
* **Trooper_1** 、 **Trooper_2** 、 **Trooper_3** 、 **Trooper_4** は、メイン キャラクターと戦い **Trooper Skeletal Mesh** を使用する敵を表します。 

[REGION:note]
**スケルタルメッシュ** は **Game/Character/Trooper/Mesh** フォルダでご覧頂けます。 
[/REGION]

キャラクターはそれぞれ **Anim** と **Movement** トラックを使用し、 Troopers 1 、 2 、 3 は表示ができるようになるまでシーンに隠す **Visibility** トラックも使用しメイン キャラクターと戦います。 

![](ActiveCharacter.png)(w:800)


**[Matinee]** ウィンドウ内で **Character** トラックあるいはキャラクターに割り当てられたすべてのトラックをクリックすれば、エディタのビューポートでそのキャラクターを強調表示することができます。こうすると、シーケンス内で操作中のキャラクターをいつでも確認できます。 

#### Character Anim トラック

キャラクターはそれぞれ、モーション キャプチャされた **アニメーション シーケンス** を持ち、これは **マチネ** の各 **Anim** トラックにが追加されています。 

![](TrooperAnimations.png)

これらは生のシーケンス、つまり短くトリムされていない長いままのカットなので、アニメーションの開始および終了時間にはフレーム 0.0 からの開始ではなくオフセットを使用します。 

例えば、 **Trooper_1** を見て、 **6.30** 地点でキーフレームをクリックすると、シーケンスが **6.50** で始まり **16.24** で終了するのを確認できます。 

![](Trooper1Example.png)

[REGION:tip]
編集したいシーケンスのキーフレームを **右クリック** して **[Set Start Offset (開始オフセットを設定)]** または **[Set End Offset (終了オフセットを設定)]** を選択することで、 **アニメーション シーケンス** の開始または終了の時間にオフセットを追加できます。表示される入力ボックスで、アニメーションを開始または終了したい時間を指定することができます。 
[/REGION]

**Game/Character/Trooper/Animation** フォルダに存在する **[Trooper_1 Animation Sequence]** を開くと、シーケンスの 5.9 秒近くまでキャラクターのアニメーションが開始しないことが分かります。 

各キャラクターのアニメーション シーケンスは、マチネ シーケンスでの表示状態に関係なく、シーン全体に配置されます。 

![](ExtraAnimSequences.png)

_**Trooper_1 Animation Sequence** は、キャラクターがまだ表示されていない場合でも追加されます (キャラクターのビジビリティは緑のバーで **On** に切り替わります)。_

追加されたこれらのアニメーション シーケンスは配置されているので、編集してショット シーケンスに再調整することも可能です。キャラクターは表示されず、各アニメーションのタイミングも設定されていないので、シーン全体の妨げにはなりませんが、最終的なシーケンスをまとめてカットする時の追加オプションとなります。 

#### Character Movement トラック

![](CharacterMovementTrack.png)

各キャラクターの **Movement** トラックは主に、シーンに入る際のキャラクターの開始位置あるいは方向を指定したり、シーンにいる間のキャラクターの位置を調整するために使用します。アニメーション シーケンスには平行移動が含まれるので、シーンでの移動はアニメーション自体が処理します。アニメーションに平行移動が含まれていない場合、シーン内でのキャラクターの移動には Movement トラックをします。 

このシーンではキャラクター間の相互作用のため、キャラクターのうちの 1 つの Movement トラックを変更すると、他のキャラクターも調整してアニメーションがその後も一緒に同期および再生するようにする必要があることはとても重要です。 

[REGION:tip]
キーフレームが Movement トラックに追加されると、 [Matinee] ウィンドウでキーフレームを選択し、ビューポートのキャラクターを希望する位置に移動させることで、キャラクターの希望する位置をそのキーフレームに指定することができます。 
[/REGION]

#### Character Visibility トラック

![](CharacterVisibilityTrack.png)

Troopers 1 、 2 、 3 に割り当てられた **Visibility** トラックは、キャラクターがシーンで表示されるべき時に切り替えるためだけのものです。上図では、キャラクターの表示時間は緑色のバーで示されています。キーフレームでも確認することができます。下向きはキャラクターが非表示、上向きの場合はキャラクターが表示される設定を表します。 

[REGION:tip]
キーフレームを **右クリック** し、コンテキスト メニューから **[Flip Toggle (切り替えをフリップ)]** オプションを選択すると、現在と逆の設定に切り替えることができます。 
[/REGION]

### Character Lighting トラック

![](CharacterLightTracks.png)

シーンには **スポットライト** が 2 つ追加され、それぞれのショットのキャラクターに追加のライトを提供しています。これらのスポットライトはそれぞれ **可動** に設定されており、 Movement トラックを使って配置されます。さらに、ショットに応じ、各ライトに対して **強度** 、 **ライトカラー** 、 **半径** がシーンの中で調整されます。以下の画像を見れば、もっと分かりやすいと思います。 

[OBJECT:EmbeddedVideo]
[PARAMLITERAL:width]
640
[/PARAMLITERAL]
[PARAMLITERAL:height]
360
[/PARAMLITERAL]
[PARAMLITERAL:videoid]
kfJeFFGuEPQ
[/PARAMLITERAL]
[/OBJECT]

**マチネのプレビュー** ではなくエディタ ビューからシーンを見ると、ショットの必要性に応じてライトのオンオフが切り替わって配置されるのが分かります。 

[REGION:tip]
マチネのプレビューは **[Viewport Options]** メニューの [Allow Matinee Preview (マチネのプレビューを許可)] オプションのチェックを外せば無効になります。 
[/REGION]

#### Character Light Movement トラック

![](CharacterLightsMovement.png)

**Primary_Light** 関数と **Secondary_Light** 関数の場合も、 **Movement** トラックは他の Movement と同様です (キーフレームに到達すると、キーフレームはライトに指定位置へ移動するように指示します)。Movement トラック上のほとんどのキーフレームが青く、 **Secondary_Light** 上のひとつのキーフレームだけ赤いことが分かります。 

キーフレームの色は、移動に使用している **Interp Mode (補間モード)** の種類を表します。このシーンの場合、ほとんどのキーフレームは **Constant** を使うように設定されています (つまり、ライトはその位置へ補間せず、その位置へジャンプします)。赤のキーフレームは、 **補間モード** が **Linear** 使用に設定されていることを示します (つまりライトはキーフレーム間を滑らかに補間し、その位置へはジャンプしません)。 

[REGION:tip]
キーフレームを **右クリック** すれば **Interp Mode** を変更できます。トラックがサポートしている場合は、表示されるコンテキスト メニューから **[Interp Mode]** オプションを選択します。 
[/REGION]


#### Character Light Intensity、LightColor、Radius

![](CharacterLightsOtherTracks.png)

各ライトの **Intensity** トラック、 **LightColor** トラック、 **Radius** トラックを使用して、ライトの **強度** 、 **ライトカラー** 、 **半径** を各キーフレーム地点で変更することができます。 

このシーンの Intensity トラックもまた、ライトの **強度** 値の微調整を行う **カーブ エディタ** を使用しています。 

![](IntensityCurveEditor.png)

[REGION:note]
カーブ エディタの詳細については、 [](Engine\UI\CurveEditor) ドキュメントを参照してください。
[/REGION]


### FX トラック (Troopers)

[REGION:fullwidth]
![](FX_Troopers.png)
[/REGION]

各 Trooper には **Particle Effect Groups** (プレフィックスが **P_**) があり、その中に **Toggle** トラックがあります。これらは、シーン中に切り替えが行われる **パーティクル エフェクト** (「 **Game/FX/Particles/Water** 」フォルダに存在) を表し、歩調に合わせてあがる水しぶきや、キャラクターの腕が相互作用する時に飛び散る水滴が含まれます。 

[REGION:tip]
**Toggle** トラックのキーフレームを追加すると、エフェクトに対して **On** 、 **Off**、 **Trigger** (再度トリガーされるまで 1 回だけエフェクトを再生する) のオプションが与えられます。 
[/REGION]

**ワールド アウトライナー** を見ると、エミッタがそれぞれ Trooper の親になっていることが分かります。 

![](CharacterParticleEffects.png)

エミッタがスポーンされると、 **ローカル** または **ワールド空間** を使ってそれらの方向を制御します (例えば、足で水を跳ね上げるには **Transform** だけが必要なので、エフェクトは **ワールド空間** に残して FX が **Z** 軸を上にして使用されます)。 

[REGION:note]
**パーティクル エフェクト** の詳細については、 [](Engine/Rendering/ParticleSystems) ドキュメントを参照してください。
[/REGION]


### FX トラック (Takedows と TileBreaks)

[REGION:fullwidth]
![](FX_TakedowsTileBreaks.png)
[/REGION]

「 **FX_Takedowns** 」フォルダおよび「 **FX_TileBreaks** 」フォルダの残りの FX グループは、シーンにおいてキャラクターが地面をヒットした時に派手にあげる水しぶきなど大きめのエフェクトの切り替えや、その名の通りキャラクターが壁をヒットした時のタイル破砕のトリガーに使用されます。 

[REGION:note]
タイル破砕を確認するには物理シミュレーションの実施が要求されるので、マチではなくエディタの実行が必要な場合があります。 
[/REGION]

#### FX Takedowns (Relative Scale 3D Track)

[REGION:fullwidth]
![](EffectsRelativeScale.png)
[/REGION]

**Movement** トラックと **Toggle** トラックは前述していますが、このセクションでは **Vector Property** トラックのコンポーネントである **RelativeScale3D** トラックという新しい種類のトラックを使用します。  

**Vector Property** トラックによって、 **アクタ** のベクター プロパティ値を時間経過とともに変更することができます (ここではパーティクル エフェクト)。**カーブエディタ** を使用すれば、このエフェクトのサイズやシーンでの見せ方を変更することができます。 


#### FX TileBreaks (Event トラック)
このセクションで使用している **Movement** トラックと **Toggle** トラックは、エフェクトの発生時と発生位置を決定しますが、 **Event** トラックがこのセクションでは重要です。 

 ![](EffectsEventTrack.png)

このトラックは **Level ブループリント** との通信およびスクリプト化されたイベントの発行に使用されます。このインスタンスでは、 (破砕したタイルの要素を構成する) **スタティックメッシュ** の構成要素を設定して物理を有効化し、それらをフロアに落とすために使用します。このトラック経由で追加された各 **イベント** に対して、スクリプト化されたイベントが **Level ブループリント** に呼び出されます。 

[REGION:note]
バラバラになる壁のタイルを構成する **スタティックメッシュ** の構成要素は、「 **Game/FX/Meshes** 」フォルダの **Wall_01** 、 **Wall_02** 、 **Wall_03** にあります。 
[/REGION]

編集のために **Level ブループリント** を開くには、メインの **ツールバー** で **[Blueprints]** ボタンをクリックして **[Open Level Blueprint]** を選択します。 

![](AccessLevelBlueprint.png)

このシーンでは以下の **Level ブループリント** を使用しています (見やすさを求める場合は、エディタ内でブループリントを見ることをお勧めします)。 

![](LevelBlueprintFull.png)(w:780)

このブループリントは、マチネがシーケンスを再度再生するためにループすると、**スタティックメッシュ オブジェクト** のリセット処理もします。スクリプトのこのポーションがないと、タイルはグラウンド上で壊れたままになります。 

[REGION:note]
ブループリントを使った作業の詳細については、 [](Engine/Blueprints) ドキュメントを参照してください。
[/REGION]


### Audio トラック

[REGION:fullwidth]
![](AudioTracks.png)
[/REGION]

様々な騎兵 (troopers) に割り当てられた「 **Audio** 」フォルダ内のそれぞれの **Sound** トラックには、シーケンス中に異なるキーフレームで再生される幾つかのサウンド アセットが含まれています。これらは、シーケンス中に聞こえてくるインパクト サウンド、唸り音、 VO の大半を作成するために使用します。 

サウンド アセットがサウンド トラックに追加されると、キーフレーム上を **右クリック** してコンテキスト メニューからアセットの **ボリューム** や **ピッチ** を調整することができます。 

![](AudioVolumePitchMenu.png)

[REGION:note]
使用されるサウンド エフェクトの大半は「 **Game/Sound/FightMatinee** 」フォルダに存在しますが、 VO は「 **Game/Sound/VO** 」フォルダ、そして音楽は「 **Game/Sound/Music** 」フォルダに存在します。上図のように、キーフレームを **右クリック** して、コンテキスト メニューから **[Find in Browser (ブラウザで検索)]** オプションを選択して特定のアセットを探すことがもできます。 
[/REGION]

### Director グループ
**トラック** はマチネのメインコースであり、 **Director グループ** およびその関連トラックはデザートとしてシーンに磨きをかけます。 

![](DirectorGroup.png)(w:800)

つまり、 **Director グループ** で特別のトラック、何よりも重要なのは **Director トラック** を利用することができます (プレイヤー ビューを引継ぎ、別のカメラなど、シーンの異なる **アクタ** に割り当てることができます)。**Fade トラック** を使ったシーンのフェード インとフェード アウトや、 **Slomo トラック** を使ったゲーム速度の増減 (**マチネ** シーケンスの再生を含む) 、 **Audio Master トラック** を使ったゲーム中のオーディオの **ボリューム** や **ピッチ** の全般的な制御、 **Color Scale トラック** を使ったシーンのカラーの変更が可能です。 

[REGION:note]
Director Group トラックを始めとするマチネで利用可能なトラックの詳細は、 [](Engine/Matinee/TrackReference) ドキュメントを参照してください。
[/REGION]

####Director トラック

![](DirectorTrack.png)

このマチネ シーケンスで **Director** トラックは、異なるカメラ視点間の切り替えに使用されることがほとんどです (多くの場合、メインとなる移動を制御する別のカメラの子供である「揺れる」カメラの使用を指定します)。 

シーケンスの好きな位置で **Enter** キーを押せば、 **Director トラック** に **ショット** を追加することができます。キーが追加されるとコンテキスト メニューが表示され、ショットをカットするための **グループ** を選択することができます (通常は **Camera アクタ**)。 

![](DirectorTrackGroupSelect.png)


####Slomo トラック

![](SlomoTrack.png)

**Slomo トラック** は時折シーンを遅くするだけでなく速めるためにも使用され、このシーケンス全体で頻繁に使われています。このトラックに追加されているキーフレームを **右クリック** し **[Set Value]** を選択すると、特定の時間に新規のゲーム速度を割り当てることができます。 

**値** 1 はデフォルトのゲーム速度を表します。 1 より小さいとシーンが遅くなり、値が大きくなるにつれてゲーム速度があがります。ほとんどのシーンでは、たまにゲーム速度が落ちることがあっても、値は 1 と 1.2 の間に留まります (例えば画像のキーフレームでは、ゲーム速度は 0.2 に落ちています)。 


#### Fade トラック

![](FadeTrack.png)

**Fade トラック** は主にシーンの始めにフェードインあるいは、シーンの終わりにフェードアウトするためのみに使用されます (この場合も当てはまります)。このトラックに追加されているキーフレームを **右クリック** し **[Set Value]** を選択すると、特定の時間にフェードする値を割り当てることができます (**Slomo トラック** と似ています)。**Fade トラック** のデフォルト値が 0 の場合はシーンはフェードアウトせず、値が 1 の場合にシーンがフェードアウトされ画面が黒くレンダリングされます。  

ただし、このサンプルでは、 **固定値の** 補間を使用してフェードインし、キーフレーム間に **線形** 補間を使ってフェードアウトさせています (フェードの最初はかなりの速さで 0 から 1 になるのに対して、フェードの終わりはかなりゆっくり 1 から 0 へ戻り、シーンがフェードアウトされます)。 

[REGION:tip]
キーフレームを **右クリック** して **[Interp Mode]** を選択し、使用しているキーフレーム間の補間のタイプを設定することができます。 
[/REGION]

####Sound  トラック

Director グループには、さらに多くのサウンド エフェクト、音楽、環境音が含まれた **Sound トラック** が幾つか追加されていることが分かります。 

![](DirectorGroupSoundTracks.png)(w:800)

Director グループに含まれる **Sound** トラックは、 [Tracks] ウィンドウ の中の「 **Audio** 」フォルダにある **Sound トラック** とひとまとめに配置されます。ただし、これらのエフェクトはオーディオの質を高め、ポリッシュとみなされることがあるので、分かりやすいようにここに入れました (どちらのセクションに入れることもできます)。 

このセクションで 1 つ注目して頂きたいことは、 **音楽** が 2 つの異なるトラックに分割されていることです。スコアの供給に 1 つの「マスター」となる音楽トラックを使用せずに、目の前で起こっている事に合わせて小さめのスニペットを配置して、シーンを際立たせます。 



#### Audio Master トラック

![](AudioMasterTrack.png)

このシーンに含まれる **Audio Master** トラック は、オーディオを標準的なボリュームとピッチにノーマライズするためのものです (デフォルト値は 1 です)。このサンプルでは Audio Master トラック上には他にキーフレームが配置されていませんが、必要に応じてキーフレームを追加して、全体的なボリュームを下げたリ、ピッチを調整することができます。 

[REGION:tip]
このトラックを使って、 **ボリューム** 設定に 1 と 0 の間に補間するキーフレームを 2 つ追加すれば、シーンの中のオーディオ (音楽、サウンド エフェクトなど) をフェードアウトさせることができます。 
[/REGION]

#### Event トラック

![](DirectorGroupEvent.png)

Director グループの **Event** トラックはシーンにおいて切り替えられる物理オブジェクトのリセットに使用します (キャラクターが壁にぶつかると砕ける **スタティックメッシュ** のタイルの構成要素です)。  

**Level ブループリント** を開くと、このイベントの呼び出しにより実行されるスクリプトのセクションは、以下のようになります (エディタ内で **ブループリント** 全体をご覧になることをお勧めします)。 

![](EventResetBlueprint.png)(w:800)


## マチネのヒントとトリック

このセクションでは、自分でシーンを生成するためのヒントとトリックを提供するだけでなく、戦闘シーンの作成に使用する技術をいくつか紹介します。 

### カメラ トランジション

**カメラ** に関するヒントでこのマチネ シーケンスで頻繁に使用されるものは、カメラ移動です。**Director** トラックを見ると、別のカメラにカットを切り替えるたびに、そのカメラの **Movement** トラック上ではカットが発生する前にキーフレームが配置されていることが分かります (下図参照)。 

![](CameraMovementTip.png)(w:800)

**Director** トラックが **Camera_Shake3** を呼び出している間、ビューと「揺れる」移動は **Camera_Shake3** に割り当てられ、親カメラ (**Camera_3**) はメインの移動パスを定めることを覚えておいてください。カットが起こる前に **Camera_3** が移動し始めるキーフレームを配置すると、カット時にカメラは既に動き始めているので、カメラにカットを行ってから移動を開始するよりも、カットへのトランジションが滑らかになります。 

### エディタ ビューをカメラに固定する

**マチネ エディタ** が開いている間、すべてのトラックをクリックすることができ、エディタのビューポートで **アクタ** が自動選択されます (トラックが **アクタ** にアタッチされている場合)。**アクタ** が選択されると、その **Actor** に対してビューポートのビューを固定することができます (カメラ **アクタ** など)。 

[REGION:lightbox]
[![](MatineeSelectedActor.png)(w:800)](MatineeSelectedActor.png)
[/REGION]

_画像をクリックして全画面表示にします。_ 

Box 1 では、 **Camera_1** の **Movement** トラック上でキーフレームが選択されています。**マチネ** の **Camera_1** グループに割り当てられた **Camera1** には、Box 2 のビューポートで選択され、 Box 3 では **ワールド アウトライナー** で選択されていることが表示されます。 

ビューポート内で **[Viewport Options]** ドロップダウン メニューをクリックして、 **[Allow Matinee Preview]** オプションのチェックを外すと・・・

![](LockCamera_DisablePreview.png)

**[Viewport Options]** ドロップダウン メニューを再びクリックすると、 **Lock Viewport to Actor (ビューポートをアクタにロックする)** オプションが表示され、拡張ウィンドウで **アクタ** を選択してロックすることができます (このケースでは **Camera1** です)。 

![](EnableLockCamera.png)

カメラをロックを選択すると、ビューが **アクタ** にロックされた状態になったことを示すアイコンがビューポートの左上隅に表示されます。 

![](LockCameraIcon.png)

**マウスの右ボタン** を押下しながら、 **W** 、 **A** 、 **S** 、 **D** キーを使うと、カメラ視点で表示しながら選択したキーフレームで好きな位置へカメラを移動させることができるようになります。 

[REGION:tip]
**マウスの右ボタン** を押下しながら、 **E** キーを押せばカメラを上方へ、また **Q** キーを押せば下方へ移動させることができます。 
[/REGION]

カメラを移動した後に **マチネ** シーケンス全体のプレビューを再開するために、カメラの移動後に **Allow Matinee Preview** を再度有効にする必要はありますが、ビューポートをカメラにロックするこの方法は、カメラを好みの位置へ移動させる場合に便利です。 

### 「手振れ」カメラ演出のヒント

手振れ演出をするために **Movement** トラックへキーフレームを追加するプロセスは一見面倒に見えますが、このヒントでプロセスを早めることができます。 

このようなタイプの移動を使うショットの場合は、まず最初にカメラのショットを開始および終了したい場所に **Start** と **End** キーフレームを作成します。 

![](ShakyTip_StartAndEnd.png)(w:800)

次に、 **タイムバー** を掴み、ショットをスクラブ再生して、定期的に **Enter** を押して終了キーフレームに到達するまでキーフレームを追加します。これは周辺の移動なので必ずしも等間隔である必要はありませんが、各キーの間は適度な間隔があった方がすっきりします。 

![](ShakyTip_EditingKeyFrames.png)(w:800)

前述の **エディタ ビューをカメラに固定する** 手法を使うと、各キーフレームを選択して、キーフレームに沿ってカメラを微動させることができます。 

揺らしたいレベルに合わせて移動幅を大きくする必要があるかもしれません。一般的には、引きつりにならない程度の微動がちょうど良いです (壁や床にぶつかったり、キャラクターを殴るなどの衝撃に使用することができます)。さらに、カメラの位置を移動させるのではなく、単にビューを回転させる程度の簡単な動きです。仕上がりをベストにするには、シーケンスをあれこれいじってスクラブ再生する必要があります。 

### キーフレームを使用したスローモーション

シーンにスローモーション シーケンスを追加する方法は、何通りかあります。 

キーフレームを 3 つ追加します。 1 つ目は通常のゲーム速度、 2 つ目はスローモーションのターゲット速度、 3 つ目は再び通常のゲーム速度に戻るキーフレームです。 

![](SlowMoExample1.png)

これは、最初と最後のキーフレームを **1** に設定し、 2 つ目を **0.2** に設定したシーケンスで使用するサンプルです。割り当てられたタイムフレームの中で、ゲーム速度を 1 から 0.2 に落として再度 1 にブレンドします。 

スローモーション シーケンス中は速度を変えずに一定に保ちたいケースもあると思います。そのような場合はキーフレームを 4 つ使います。最初の 2 つは通常速度からターゲット速度へ、残りの 2 つはターゲット速度から通常速度へとブレンドさせます。 

![](SlowMoExample2.png)

このサンプルでは、 2 つ目と 3 つ目の間は速度は変わらず、シーケンスは割り当てられたタイムフレームの間は一定の速度で再生します。 


### 便利なマチネ ビュー オプション

**マチネ エディタ** のファイルメニューの **[View]** にある以下の 2 つのオプションは、有効にしておくと便利です。 

[REGION:imagetable]
| ![](ViewOption1.png) | ![](ViewOption2.png) |
| :---: | :---: |
| Zoom To Time Cursor Position (タイムカーソル位置へズーム) | Allow Keyframe Bar Selection (キーフレームバーの選択を許可) |
[/REGION]

2 つともデフォルトではオフ設定です。 **[View]** メニューでオンにすることができます。 

**[Zoom To Time Cursor Position (タイムカーソル位置へズーム)]** を使うと、 **タイムバー** の現在位置から **マウスホイール** を奥へ (ズームイン) あるいは手前へ (ズームアウト) 回すことができます。シーケンスのスクラブ時にこのオプションがオフになっていると、 **タイムバー** の新しい位置へスクロール バーを移動させなければならないので、少々面倒です (このオプションはこの問題を軽減します)。 

**[Allow Keyframe Bar Selection (キーフレームバーの選択を許可)]** は、キーフレーム自体をクリックするのではなく、キーフレームと関連付いているバーをクリックできるという点で便利です。 

![](KeyframeBarSelect.png)

上図では、紫のバー上のどこかをクリックすればこのショットと関連付いているキーフレームが選択されます。このオプションがオフになっている場合は、実際のキーフレームを自体をクリックして選択する必要があります。 

### 再生のショートカット

以下のキーボード ショートカットを使って、 **マチネ** シーケンスの再生を制御することができます。 

| ショートカット | 説明 |
| ------- | ------------ |
| **P** | 現在位置からシーケンスを **再生** または **一時停止** します。  |
| **L** | 現在位置からシーケンスの **再生** のみを行います。 |
| **K** | 現在位置でシーケンスを **停止** します。 |
| **J** | 現在位置からシーケンスを **逆再生** します。 |

### シーンの合成

以下は、さらに興味深くまとまりのある合成を作成するヒントです。ショットを設定し、シーケンスを完成させる際にはこれらを覚えておいてください。 

#### スクリーンの方向

スクリーンの方向に留意してください。画面の左側にキャラクターを、そして右側に敵が表示されるように作成した場合、忠実度を保ち、カメラカットの間は左右を入れ替えないことが重要です。左右の入れ替えは可能ですが、カットの前にそれらの入れ替えを実演した方がいいかもしれません。 

#### 三分割法
ショットにおいて三分割法を利用してみてください。これは、等間隔に引いた水平線と垂直線 2 本ずつにより画面を 9 等分すると仮定し、それらの線上、もしくは線同士の交点上に構図上の重要な要素を配置するとよいとする、一般的な写真のガイドラインです。 

[REGION:imagetable]
| [INCLUDE:#v11] |![](RuleofThirdsMatinee.png)(h:240)|
| :---: | :---: |
| センター ショットと三分割法ショット | マチネのサンプル |
[/REGION]

<!--
[EXCERPT:v11]
[OBJECT:EmbeddedVideo]
[PARAMLITERAL:width]
460
[/PARAMLITERAL]
[PARAMLITERAL:height]
240
[/PARAMLITERAL]
[PARAMLITERAL:videoid]
xnuP2mepDjs
[/PARAMLITERAL]
[/OBJECT]
[/EXCERPT]
-->

#### ショットのフレーミング

ショットをフレーミング、すなわちシーンにある別の何かでショットの他の部分をブロックすることでショット対象物への注意を引き付けると、さらにショットにコンテキストが与えられ、ショットに深度やレイヤーが追加されます。 

以下を例に見てみましょう。 

![](FramingShots1.png)(w:640)

ショットが壁に繋がっているパイプと床の死体でフレーミングされていることに注目してください。 

これらのエレメントをトリミングして、キャラクター全体を表示したままにすれば、よりタイトなショットで簡単にショットできますが、シーンは視覚的には面白くありません。 

![](FramingShots2b.png)(w:640)

#### 視線誘導

ショットに使えそうなもう 1 つの写真の編集技術は、シーンのキャラクターまたは対象物に視線を誘導する視線誘導です。 

以下を例に見てみましょう。 

![](LeadingLines1.png)(w:640)

壁または床に沿ってパイプは、ユーザーの視線をシーン内のキャラクターへ誘導するような方向に伸びています。 

別の例として次のシーケンスを見てみましょう。 

![](LeadingLines2.png)(w:640)

このショットにはキャラクターが入っていませんが、これが次のショットのための設定となっています。 

![](LeadingLines2b.png)(w:640)


## オリジナルを作ってみる (マチネの編集)

このセクションでは、いくつかのサンプルを使ってシーンを修正し、リミックスしたバージョンを作成する方法を紹介します。 

### 作業を開始する

まず最初に **MatineeFightScene** レベルを新規レベルとして保存し、オリジナルのバージョンを維持します。 

**[File]** メニューから **[SaveAs (名前を付けて保存)]** を選択し (または **Control+Shift+S**) 、新規名をつけてマップを保存します。

[REGION:tip]
このプロジェクトを使って、新規プロジェクト用に **テンプレート** を作成することもできます。詳細は [](Engine/Basics/Projects/CreatingTemplates) を参照してください。 
[/REGION]

###編集例

以下はオリジナルのシーケンスをリミックスした例です。 

[OBJECT:EmbeddedVideo]
[PARAMLITERAL:width]
640
[/PARAMLITERAL]
[PARAMLITERAL:height]
360
[/PARAMLITERAL]
[PARAMLITERAL:videoid]
kzXg1NY4Aag
[/PARAMLITERAL]
[/OBJECT]

ビデオを見ると分かりますが、シーンは様々な方法で修正することができます。上記のビデオでは、以下が修正されています。 

* いくつかのショットで、カメラのアングルを変更。 
* 新しい手振れカメラの動きを追加して、一部のショットで大きな衝撃で揺れるカメラを使用。 
* いくつかのショットで、カメラの **Movement** トラックでキーフレームを調整して 1 人称視点を使用。 
* シーンで使っている各カメラの **[Film]** 設定で、 **サチュレーション** 値と **固定** 値を 0.0 に設定し、白黒間を創出。 
* サウンドをすべてストリップし、単一の楽譜に置換。 
* シーンのほとんどの部分のゲーム速度を 0.7 で再生 (slowmo シーケンスの場合は例外で 0.08 に設定されている)。 
* メインの階段上の頭蓋骨にカットアウェイ ショットを追加。 

シーケンスのカットを再配置したり、シーンのキャラクターの位置変え (あるいは、全く別のシーンを使用)、別のパーティクルやサウンド エフェクトを追加、DOF やキャラクター ライトなどの設定を使って、 自分だけのオリジナルシーンにすることができます。






